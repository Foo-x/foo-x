{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/elm-phoenix-websocket/","result":{"data":{"markdownRemark":{"fields":{"slug":"/blog/elm-phoenix-websocket/"},"id":"b6e78c97-6a09-5e5b-a2c2-e49498c62f7d","excerpt":"背景 Elm 0.19が8月、Phoenix 1.4が11月にリリースされました  Elmについてはコンパイルが爆速になったり、成果物のサイズが小さくなったり、標準ライブラリのAPIに破壊的変更が入ったりなど、大きな変更が加えられました。(詳しくはこちら)  PhoenixについてもHTTP2のサポートが入ったり、JS…","html":"<h2 id=\"背景\" style=\"position:relative;\"><a href=\"#%E8%83%8C%E6%99%AF\" aria-label=\"背景 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>背景</h2>\n<p>Elm 0.19が8月、Phoenix 1.4が11月にリリースされました <img class=\"emoji\" draggable=\"false\" alt=\"&#x1F389;\" src=\"https://twemoji.maxcdn.com/2/72x72/1f389.png\" style=\"height: 1em; width: 1em; margin: 0 .05em 0 .1em; vertical-align: -0.1em;\"><br>\nElmについてはコンパイルが爆速になったり、成果物のサイズが小さくなったり、標準ライブラリのAPIに破壊的変更が入ったりなど、大きな変更が加えられました。(詳しくは<a href=\"https://github.com/elm/compiler/blob/master/upgrade-docs/0.19.md\">こちら</a>)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fac81e36bae6ac9421334ef636653a95/50383/asset-size.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.72151898734178%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACBklEQVQ4y5WU6YoaQRDH5zXyKR8WAnmJPF32HSLR0dHxBCWwAQlBEJVoHB1WsxkS3HUXzxHv+5rxH6tMmygGsg1NT3V1/bqOrpFwYSyXSwyHQ4xGI0yn0+OczWYYj8eYz+f8vVgs+PxutzvaSmRkWRY2mw0fWK/XME2TJ+n6/T7DB4MBut0u75Pc6XQYLoBiSpPJhDeLxSIikQji8Tii0Sjq9TqazSYDarXa0Zvz8TeMgUKhaRpkWYbf70cwGEQmk4HP50MsFoPH4+ELLsHOh0SuCw/dbjcDQ6EQcrkcvF4vQwOBAOtpj9ZUKoV2u812tm2feihuKRQKJ8BsNstAISeTSSiKwrLT6USlUrkMFLn5F1BVVU5BOp3mlfSUgmq1ehnY6/X+C0hhUugCeP/wwHb0Qqw91LbPivIcIJ17eqyK0pwUSaK39RygSq/Aq+Bz6TuujRbc9ybefqsh3Tm8SYm6QlSZQiGjcDjMFaUK0wUkixyq/gCifhXq1xJefbzFm08lXH0o4H3FPAApqTQI4HA4GEqeEcDlch3lRCLBVZbpUtkF5YuOlze3eH2j40VU+wOkNtput9xK5CWFbhgGWq0WdF1HPp9HuVxGo9FgvbbXl/QifppduH40IN894t3dE4zh/AAU5RYVW61WxyRTf1NrCj3pKEXW76hgb/d/kj3I2hzE/blfq/TUUn8qhIkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/fac81e36bae6ac9421334ef636653a95/f058b/asset-size.png\"\n        srcset=\"/static/fac81e36bae6ac9421334ef636653a95/c26ae/asset-size.png 158w,\n/static/fac81e36bae6ac9421334ef636653a95/6bdcf/asset-size.png 315w,\n/static/fac81e36bae6ac9421334ef636653a95/f058b/asset-size.png 630w,\n/static/fac81e36bae6ac9421334ef636653a95/50383/asset-size.png 740w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>PhoenixについてもHTTP2のサポートが入ったり、JSのバンドラーがBrunchからWebpackになったりしました。(詳しくは<a href=\"https://phoenixframework.org/blog/phoenix-1-4-0-released\">こちら</a>)</p>\n<p>それぞれの変更に伴い、Elm + Elixir/PhoenixでWebSocket通信を行う方法が変わりました。この記事ではその手順をまとめます。</p>\n<h2 id=\"プロジェクト作成まで\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90%E3%81%BE%E3%81%A7\" aria-label=\"プロジェクト作成まで permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロジェクト作成まで</h2>\n<h3 id=\"elmインストール\" style=\"position:relative;\"><a href=\"#elm%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-label=\"elmインストール permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elmインストール</h3>\n<ol>\n<li>\n<p>Node.jsインストール</p>\n<ul>\n<li>OSによるため公式を参照: <a href=\"https://nodejs.org/ja/download/\">https://nodejs.org/ja/download/</a></li>\n</ul>\n</li>\n<li><code class=\"language-text\">$ npm install -g elm</code></li>\n<li><code class=\"language-text\">$ elm</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Hi, thank you for trying out Elm 0.19.0. I hope you like it!\n...</code></pre></div>\n<h3 id=\"elixirphoenixインストール\" style=\"position:relative;\"><a href=\"#elixirphoenix%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-label=\"elixirphoenixインストール permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elixir/Phoenixインストール</h3>\n<ol>\n<li>\n<p>Elixirインストール</p>\n<ul>\n<li>OSによるため公式を参照: <a href=\"https://elixir-lang.org/install.html\">https://elixir-lang.org/install.html</a></li>\n</ul>\n</li>\n<li><code class=\"language-text\">$ mix local.hex</code></li>\n<li><code class=\"language-text\">$ mix archive.install hex phx_new 1.4.0</code></li>\n<li><code class=\"language-text\">$ mix archive</code></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">...\n* phx_new-1.4.0</code></pre></div>\n<h3 id=\"プロジェクト作成\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\" aria-label=\"プロジェクト作成 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロジェクト作成</h3>\n<ol>\n<li>\n<p><code class=\"language-text\">$ mix phx.new elm_websocket_sample --no-ecto</code></p>\n<ul>\n<li><code class=\"language-text\">elm_websocket_sample</code>はプロジェクト名(適宜変更)</li>\n<li><code class=\"language-text\">--no-ecto</code>はDBを使わない設定</li>\n</ul>\n</li>\n<li>依存関係のインストールを行うか聞かれるのでEnter</li>\n<li><code class=\"language-text\">$ cd elm_websocket_sample</code></li>\n<li><code class=\"language-text\">$ mix phx.server</code></li>\n<li>ブラウザで<a href=\"http://localhost:4000/\">http://localhost:4000/</a> にアクセスして以下の画面が表示されればOK</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9300cd4457837eefc844ae331f4c6fae/52a2d/phoenix.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.89873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABRElEQVQoz31Sy26DMBDM//9V7z3lAGkkCKogjcLLGIyDsT31GkpNUnWl0Xpf41nMwRgDozXIa2Mxvb9B5hecTh9Izmd8FQVY26KuKocSQggAFnKaIeTs50IctoBIXavKU6hbjqK44jO7oCpLDH0P3nVomwZSSlhroJTGpPQrobUWBDLrEnyU6AaBcRzRDwM6ztE5MsYY2OopJvQ9/51deQ4/ARnd0NS1V9W6NdM0xfF4xNmtHsexP+d57muV+wRN0/qZkGOnkIq1IyTc73dkWYYoihBHsSckJEniaqXvIeKQ8EUheb6u2LjvtahotuEwR6D1w1mv8Hnl0ikjguebiVC7h1uTW/5fQvKM06NMW25lQC8emGZ6Set/r9DC3h0h3czFDCb0NrTUlvytVai4wkPt1b8oXFZYlNCBVOwbl9j8QfBs3/BpCUxtSI8lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/9300cd4457837eefc844ae331f4c6fae/f058b/phoenix.png\"\n        srcset=\"/static/9300cd4457837eefc844ae331f4c6fae/c26ae/phoenix.png 158w,\n/static/9300cd4457837eefc844ae331f4c6fae/6bdcf/phoenix.png 315w,\n/static/9300cd4457837eefc844ae331f4c6fae/f058b/phoenix.png 630w,\n/static/9300cd4457837eefc844ae331f4c6fae/40601/phoenix.png 945w,\n/static/9300cd4457837eefc844ae331f4c6fae/78612/phoenix.png 1260w,\n/static/9300cd4457837eefc844ae331f4c6fae/52a2d/phoenix.png 2534w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>以下、トップの<code class=\"language-text\">/</code>はプロジェクトルートとします。<br>\n例えば<code class=\"language-text\">cd /lib</code>はプロジェクトルート直下の<code class=\"language-text\">lib/</code>に<code class=\"language-text\">cd</code>するという意味です。</p>\n<h2 id=\"elmで画面表示\" style=\"position:relative;\"><a href=\"#elm%E3%81%A7%E7%94%BB%E9%9D%A2%E8%A1%A8%E7%A4%BA\" aria-label=\"elmで画面表示 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elmで画面表示</h2>\n<ol>\n<li><code class=\"language-text\">$ mkdir /assets/elm</code></li>\n<li><code class=\"language-text\">$ cd /assets/elm</code></li>\n<li>\n<p><code class=\"language-text\">$ elm init</code></p>\n<ul>\n<li>elm.jsonを作成するか聞かれるのでEnter</li>\n</ul>\n</li>\n<li>Main.elm</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"elm\"><pre class=\"language-elm\"><code class=\"language-elm\"><span class=\"token comment\">-- /assets/elm/Main.elm</span>\n\n<span class=\"token keyword\">module</span> <span class=\"token constant\">Main</span> <span class=\"token keyword\">exposing</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">main</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Browser</span><span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Html <span class=\"token keyword\">exposing</span> </span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\"><span class=\"token keyword\">import</span> Html.Attributes <span class=\"token keyword\">exposing</span> </span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">)</span>\n\n\n\n<span class=\"token comment\">-- MODEL</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token keyword\">alias</span> <span class=\"token constant\">Model</span>\n    <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">init</span> _ <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n\n\n<span class=\"token comment\">-- VIEW</span>\n\n\n<span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">view</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">div</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"Hello World!\"</span> <span class=\"token punctuation\">]</span>\n\n\n\n<span class=\"token comment\">-- UPDATE</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token keyword\">alias</span> <span class=\"token constant\">Msg</span>\n    <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n\n<span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">update</span> <span class=\"token hvariable\">msg</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n\n\n<span class=\"token comment\">-- SUBSCRIPTIONS</span>\n\n\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Sub</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">Sub.none</span>\n\n\n\n<span class=\"token comment\">-- MAIN</span>\n\n\n<span class=\"token hvariable\">main</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Program</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">Model</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">main</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">Browser.element</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">init</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">view</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">update</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">subscriptions</span>\n        <span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"5\">\n<li>app.js</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// /assets/js/app.js</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Elm <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../elm/src/Main.elm\"</span>\n\nElm<span class=\"token punctuation\">.</span>Main<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    node<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"elm-container\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<ol start=\"6\">\n<li><code class=\"language-text\">$ cd /assets</code></li>\n<li><code class=\"language-text\">$ npm install --save-dev elm-webpack-loader</code></li>\n<li>webpack.config.js</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// /assets/webpack.config.js</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">env<span class=\"token punctuation\">,</span> options</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    module<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    rules<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token comment\">// ...</span>\n        <span class=\"token punctuation\">{</span>\n        test<span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\.elm$</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span>\n        exclude<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">elm-stuff</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">,</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">node_modules</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        use<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            loader<span class=\"token operator\">:</span> <span class=\"token string\">'elm-webpack-loader'</span><span class=\"token punctuation\">,</span>\n            options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            cwd<span class=\"token operator\">:</span> __dirname <span class=\"token operator\">+</span> <span class=\"token string\">\"/elm\"</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol start=\"9\">\n<li><code class=\"language-text\">/lib/elm_websocket_sample_web/templates/layout/app.html.eex</code>の<code class=\"language-text\">&lt;header&gt;</code>を削除</li>\n<li>index.html.eex</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token comment\">&lt;!-- /lib/elm_websocket_sample_web/templates/page/index.html.eex --></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>elm-container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ol start=\"11\">\n<li><code class=\"language-text\">$ mix phx.server</code></li>\n<li>ブラウザで<a href=\"http://localhost:4000/\">http://localhost:4000/</a> にアクセスして以下の画面が表示されればOK</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 328px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc8595223c0d2717a2ca71654c707e49/d5c60/hello-world.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.316455696202528%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAArUlEQVQY041P0QqCQBD0/3/FIrMgAsuH7NEPULvjXnwRBE/RU0+dvCNDLoQGhl1mmd1ZCx9M06TrOI6QUuq+6zoMw6DZCoG6brQu+x6ibdHM2tqrYJkLq7JCEDzhOgfsnDP8uw9KCNzjCba9x83z8Jjnl6uHMAy/ITYX9vP1PM+RJDEIZaCUoig40jQFYwxRFCPLMrwIBed8O6E5+Bem5yehqorqjYWmtvRrz4I35vCBX/GD66IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/dc8595223c0d2717a2ca71654c707e49/d5c60/hello-world.png\"\n        srcset=\"/static/dc8595223c0d2717a2ca71654c707e49/c26ae/hello-world.png 158w,\n/static/dc8595223c0d2717a2ca71654c707e49/6bdcf/hello-world.png 315w,\n/static/dc8595223c0d2717a2ca71654c707e49/d5c60/hello-world.png 328w\"\n        sizes=\"(max-width: 328px) 100vw, 328px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"websocket実装\" style=\"position:relative;\"><a href=\"#websocket%E5%AE%9F%E8%A3%85\" aria-label=\"websocket実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebSocket実装</h2>\n<h3 id=\"phoenix側\" style=\"position:relative;\"><a href=\"#phoenix%E5%81%B4\" aria-label=\"phoenix側 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Phoenix側</h3>\n<ol>\n<li><code class=\"language-text\">$ mix phx.gen.channel Room</code></li>\n<li>user_socket.ex</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\"><span class=\"token comment\"># /lib/elm_websocket_sample_web/channels/user_socket.ex</span>\n\n<span class=\"token keyword\">defmodule</span> ElmWebsocketSampleWeb<span class=\"token punctuation\">.</span>UserSocket <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">use</span> Phoenix<span class=\"token punctuation\">.</span>Socket\n\n    <span class=\"token comment\">## Channels</span>\n    channel <span class=\"token string\">\"room:*\"</span><span class=\"token punctuation\">,</span> ElmWebsocketSampleWeb<span class=\"token punctuation\">.</span>RoomChannel <span class=\"token comment\"># ← コメントアウトを解除</span>\n\n    <span class=\"token comment\"># ...</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h3 id=\"elm側\" style=\"position:relative;\"><a href=\"#elm%E5%81%B4\" aria-label=\"elm側 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elm側</h3>\n<p>Elm 0.18までは公式のライブラリでWebSocketがサポートされていたのですが、0.19では現時点で存在しません。<br>\nそのため、WebSocket通信を行うにはJavaScriptを通して行う必要があります。<br>\n<a href=\"https://github.com/paulstatezny/elm-phoenix-websocket-ports\">elm-phoenix-websocket-ports</a>というライブラリが使いやすかったのでそちらを使用した方法を紹介します。</p>\n<ol>\n<li><code class=\"language-text\">$ cd /assets</code></li>\n<li><code class=\"language-text\">$ npm install elm-phoenix-websocket-ports</code></li>\n<li>elm.json</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// /assets/elm/elm.json</span>\n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"source-directories\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"../node_modules/elm-phoenix-websocket-ports/lib/elm\"</span><span class=\"token punctuation\">,</span>\n        ...\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    ...\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"4\">\n<li><code class=\"language-text\">$ cd /assets/elm</code></li>\n<li><code class=\"language-text\">$ elm install elm/json</code></li>\n<li>Main.elm</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"elm\"><pre class=\"language-elm\"><code class=\"language-elm\"><span class=\"token comment\">-- /assets/elm/Main.elm</span>\n\n<span class=\"token keyword\">module</span> <span class=\"token constant\">Main</span> <span class=\"token keyword\">exposing</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">main</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Browser</span><span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Html <span class=\"token keyword\">exposing</span> </span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\"><span class=\"token keyword\">import</span> Html.Attributes <span class=\"token keyword\">exposing</span> </span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\"><span class=\"token keyword\">import</span> Html.Events <span class=\"token keyword\">exposing</span> </span><span class=\"token punctuation\">(</span><span class=\"token operator\">..</span><span class=\"token punctuation\">)</span>\n<span class=\"token import_statement\"><span class=\"token keyword\">import</span> Json.Decode <span class=\"token keyword\">as</span> D</span><span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Json.Encode <span class=\"token keyword\">as</span> E</span><span class=\"token import_statement\">\n<span class=\"token keyword\">import</span> Ports.Websocket <span class=\"token keyword\">as</span> Websocket</span>\n\n\n\n<span class=\"token comment\">-- MODEL</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token keyword\">alias</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span>\n    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">init</span> _ <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Websocket.websocketListen</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n\n\n\n<span class=\"token comment\">-- VIEW</span>\n\n\n<span class=\"token hvariable\">view</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Html</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">view</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">div</span>\n        <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">div</span>\n            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">input</span>\n                <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">type_</span> <span class=\"token string\">\"text\"</span>\n                <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">onInput</span> <span class=\"token constant\">UpdateInputText</span>\n                <span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">button</span>\n                <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">onClick</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Send</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">.</span><span class=\"token hvariable\">inputText</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span>\n                <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token string\">\"送信\"</span> <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">div</span>\n            <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">[</span> <span class=\"token hvariable\">text</span> <span class=\"token operator\">&lt;|</span> <span class=\"token string\">\"received: \"</span> <span class=\"token operator\">++</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">.</span><span class=\"token hvariable\">receivedText</span> <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">]</span>\n\n\n\n<span class=\"token comment\">-- UPDATE</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token constant\">Msg</span>\n    <span class=\"token operator\">=</span> <span class=\"token constant\">WebsocketReceive</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">String</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">String</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">D.Value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">UpdateInputText</span> <span class=\"token constant\">String</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">Send</span> <span class=\"token constant\">String</span>\n\n\n<span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">update</span> <span class=\"token hvariable\">msg</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token keyword\">case</span> <span class=\"token hvariable\">msg</span> <span class=\"token keyword\">of</span>\n        <span class=\"token constant\">WebsocketReceive</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">payload</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">case</span> <span class=\"token hvariable\">D.decodeValue</span> <span class=\"token hvariable\">textDecoder</span> <span class=\"token hvariable\">payload</span> <span class=\"token keyword\">of</span>\n                <span class=\"token constant\">Ok</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">-></span>\n                    <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">|</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n                <span class=\"token constant\">Err</span> _ <span class=\"token operator\">-></span>\n                    <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n        <span class=\"token constant\">WebsocketReceive</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span>\n            <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n        <span class=\"token constant\">UpdateInputText</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">-></span>\n            <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">|</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">inputText</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n\n        <span class=\"token constant\">Send</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">-></span>\n            <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Websocket.websocketSend</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">textEncoder</span> <span class=\"token hvariable\">inputText</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n\n\n<span class=\"token hvariable\">textDecoder</span> <span class=\"token operator\">:</span> <span class=\"token constant\">D.Decoder</span> <span class=\"token constant\">String</span>\n<span class=\"token hvariable\">textDecoder</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">D.at</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">]</span> <span class=\"token hvariable\">D.string</span>\n\n\n<span class=\"token hvariable\">textEncoder</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span> <span class=\"token operator\">-></span> <span class=\"token constant\">E.Value</span>\n<span class=\"token hvariable\">textEncoder</span> <span class=\"token hvariable\">string</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">E.object</span>\n        <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">E.string</span> <span class=\"token hvariable\">string</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span>\n\n\n<span class=\"token comment\">-- SUBSCRIPTIONS</span>\n\n\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Sub</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">Websocket.websocketReceive</span> <span class=\"token constant\">WebsocketReceive</span>\n\n\n\n<span class=\"token comment\">-- MAIN</span>\n\n\n<span class=\"token hvariable\">main</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Program</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token constant\">Model</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">main</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">Browser.element</span>\n        <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">init</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">init</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">view</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">view</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">update</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">update</span>\n        <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">subscriptions</span>\n        <span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"7\">\n<li>app.js</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// /assets/js/app.js</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> phoenix <span class=\"token keyword\">from</span> <span class=\"token string\">\"phoenix\"</span>\n<span class=\"token keyword\">import</span> websocketPortsFactory <span class=\"token keyword\">from</span> <span class=\"token string\">\"elm-phoenix-websocket-ports\"</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Elm <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"../elm/src/Main.elm\"</span>\n\n<span class=\"token keyword\">const</span> socketAddress <span class=\"token operator\">=</span> <span class=\"token string\">\"/socket\"</span>\n<span class=\"token keyword\">const</span> websocketPorts <span class=\"token operator\">=</span> <span class=\"token function\">websocketPortsFactory</span><span class=\"token punctuation\">(</span>phoenix<span class=\"token punctuation\">,</span> socketAddress<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> elm <span class=\"token operator\">=</span> Elm<span class=\"token punctuation\">.</span>Main<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    node<span class=\"token operator\">:</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"elm-container\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nwebsocketPorts<span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span>elm<span class=\"token punctuation\">.</span>ports<span class=\"token punctuation\">)</span></code></pre></div>\n<ol start=\"8\">\n<li><code class=\"language-text\">$ mix phx.server</code></li>\n<li>ブラウザで<a href=\"http://localhost:4000/\">http://localhost:4000/</a> にアクセスし、inputに入力して送信ボタンを押すとメッセージが送られます。Phoenixでは受け取った文字列を接続中のクライアントすべてに返し、Elmで受け取った結果が<code class=\"language-text\">received:</code>に表示されます。タブを２つ以上開いておくと送信していないタブでも表示されるはずです。</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9d91d081c1e07cb633b662d338ba52c7/1acf3/test.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.455696202531648%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAW0lEQVQI153FvQmAMBQA4azrFI5hLdg6gpVWbmBhITYKQn6USDAvZyEukIOPUxDhsYTzwDqHiCAxfs+g+umiqBeqbock/KWUsqhxdpTtSjNs3N6jtcYYQwiBnF6xu+lZrMuxRwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image.png\"\n        title=\"image.png\"\n        src=\"/static/9d91d081c1e07cb633b662d338ba52c7/f058b/test.png\"\n        srcset=\"/static/9d91d081c1e07cb633b662d338ba52c7/c26ae/test.png 158w,\n/static/9d91d081c1e07cb633b662d338ba52c7/6bdcf/test.png 315w,\n/static/9d91d081c1e07cb633b662d338ba52c7/f058b/test.png 630w,\n/static/9d91d081c1e07cb633b662d338ba52c7/40601/test.png 945w,\n/static/9d91d081c1e07cb633b662d338ba52c7/78612/test.png 1260w,\n/static/9d91d081c1e07cb633b662d338ba52c7/1acf3/test.png 1596w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"解説\" style=\"position:relative;\"><a href=\"#%E8%A7%A3%E8%AA%AC\" aria-label=\"解説 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>解説</h2>\n<h3 id=\"phoenix側-1\" style=\"position:relative;\"><a href=\"#phoenix%E5%81%B4-1\" aria-label=\"phoenix側 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Phoenix側</h3>\n<p>Phoenixには、WebSocketでの送受信に関する処理を行うChannelというモジュールが用意されています。<br>\n<code class=\"language-text\">$ mix phx.gen.channel Room</code>というコマンドを実行すると、”RoomChannel”が自動で作成されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"elixir\"><pre class=\"language-elixir\"><code class=\"language-elixir\"><span class=\"token comment\"># /lib/elm_websocket_sample_web/channels/room_channel.ex</span>\n\n<span class=\"token keyword\">defmodule</span> ElmWebsocketSampleWeb<span class=\"token punctuation\">.</span>RoomChannel <span class=\"token keyword\">do</span>\n  <span class=\"token keyword\">use</span> ElmWebsocketSampleWeb<span class=\"token punctuation\">,</span> <span class=\"token atom symbol\">:channel</span>\n\n  <span class=\"token keyword\">def</span> join<span class=\"token punctuation\">(</span><span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token keyword\">if</span> authorized?<span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:ok</span><span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span>\n      <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:error</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">%</span><span class=\"token punctuation\">{</span><span class=\"token attr-name\">reason:</span> <span class=\"token string\">\"unauthorized\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token comment\"># ...</span>\n\n  <span class=\"token keyword\">def</span> handle_in<span class=\"token punctuation\">(</span><span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    broadcast socket<span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> payload\n    <span class=\"token punctuation\">{</span><span class=\"token atom symbol\">:noreply</span><span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">end</span>\n\n  <span class=\"token keyword\">defp</span> authorized?<span class=\"token punctuation\">(</span>_payload<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span>\n    <span class=\"token boolean\">true</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">join(&quot;room:lobby&quot;, payload, socket)</code></p>\n<ul>\n<li>”room:lobby”というトピックの定義と、購読時の処理の実装です。</li>\n<li><code class=\"language-text\">authorized?</code>がtrueの場合はok, falseの場合はerrorを返します。</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">handle_in(&quot;shout&quot;, payload, socket)</code></p>\n<ul>\n<li>”shout”というイベントのメッセージを受信した時の処理の実装です。</li>\n<li><code class=\"language-text\">payload</code>は受信したメッセージです。</li>\n<li><code class=\"language-text\">socket</code>はメッセージの送信元とのソケットです。</li>\n<li><code class=\"language-text\">broadcast</code>の部分では、<code class=\"language-text\">socket</code>と同じトピック(ここでは”room:lobby”)を購読しているクライアントに対し、受信したメッセージを”shout”というイベントでそのまま送信しています。</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">authorized?(_payload)</code></p>\n<ul>\n<li>メッセージをもとに認証を行う処理の実装ですが、デフォルトでは常にtrueを返しています。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"elm側-1\" style=\"position:relative;\"><a href=\"#elm%E5%81%B4-1\" aria-label=\"elm側 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Elm側</h3>\n<div class=\"gatsby-highlight\" data-language=\"elm\"><pre class=\"language-elm\"><code class=\"language-elm\"><span class=\"token comment\">-- ...</span>\n\n<span class=\"token hvariable\">init</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">init</span> _ <span class=\"token operator\">=</span>\n    <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Websocket.websocketListen</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">-- ...</span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">Websocket.websocketListen (&quot;room:lobby&quot;, &quot;shout&quot;)</code></p>\n<ul>\n<li>”room:lobby”というトピックの”shout”というイベントのメッセージを受信できるように登録しています。</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"elm\"><pre class=\"language-elm\"><code class=\"language-elm\"><span class=\"token comment\">-- UPDATE</span>\n\n\n<span class=\"token keyword\">type</span> <span class=\"token constant\">Msg</span>\n    <span class=\"token operator\">=</span> <span class=\"token constant\">WebsocketReceive</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">String</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">String</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">D.Value</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">-- ...</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">Send</span> <span class=\"token constant\">String</span>\n\n\n<span class=\"token hvariable\">update</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Msg</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token punctuation\">(</span> <span class=\"token constant\">Model</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">Cmd</span> <span class=\"token constant\">Msg</span> <span class=\"token punctuation\">)</span>\n<span class=\"token hvariable\">update</span> <span class=\"token hvariable\">msg</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token keyword\">case</span> <span class=\"token hvariable\">msg</span> <span class=\"token keyword\">of</span>\n        <span class=\"token constant\">WebsocketReceive</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">payload</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span>\n            <span class=\"token keyword\">case</span> <span class=\"token hvariable\">D.decodeValue</span> <span class=\"token hvariable\">textDecoder</span> <span class=\"token hvariable\">payload</span> <span class=\"token keyword\">of</span>\n                <span class=\"token constant\">Ok</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">-></span>\n                    <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">{</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">|</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">receivedText</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Cmd.none</span> <span class=\"token punctuation\">)</span>\n                <span class=\"token comment\">-- ...</span>\n        <span class=\"token comment\">-- ...</span>\n\n        <span class=\"token constant\">Send</span> <span class=\"token hvariable\">inputText</span> <span class=\"token operator\">-></span>\n            <span class=\"token punctuation\">(</span> <span class=\"token hvariable\">model</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">Websocket.websocketSend</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"room:lobby\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shout\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">textEncoder</span> <span class=\"token hvariable\">inputText</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span>\n\n\n<span class=\"token hvariable\">textDecoder</span> <span class=\"token operator\">:</span> <span class=\"token constant\">D.Decoder</span> <span class=\"token constant\">String</span>\n<span class=\"token hvariable\">textDecoder</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">D.at</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">]</span> <span class=\"token hvariable\">D.string</span>\n\n\n<span class=\"token hvariable\">textEncoder</span> <span class=\"token operator\">:</span> <span class=\"token constant\">String</span> <span class=\"token operator\">-></span> <span class=\"token constant\">E.Value</span>\n<span class=\"token hvariable\">textEncoder</span> <span class=\"token hvariable\">string</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">E.object</span>\n        <span class=\"token punctuation\">[</span> <span class=\"token punctuation\">(</span> <span class=\"token string\">\"data\"</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">E.string</span> <span class=\"token hvariable\">string</span> <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>\n<p><code class=\"language-text\">WebsocketReceive (&quot;room:lobby&quot;, &quot;shout&quot;, payload)</code></p>\n<ul>\n<li>”room:lobby”というトピックの”shout”というイベントのメッセージを受信したときの処理の実装です。</li>\n<li>JSONをデコードし、modelの<code class=\"language-text\">receivedText</code>にセットしています。</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">Send inputText</code></p>\n<ul>\n<li>文字列をJSONにエンコードし、”room:lobby”というトピックの”shout”というイベントでメッセージを送信する処理の実装です。</li>\n</ul>\n</li>\n<li>\n<p>textDecoder</p>\n<ul>\n<li>JSONのデコーダです。</li>\n<li><code class=\"language-text\">{ &quot;data&quot;: &quot;foo&quot; }</code>の<code class=\"language-text\">&quot;foo&quot;</code>を取り出す実装になっています。</li>\n</ul>\n</li>\n<li>\n<p>textEncoder</p>\n<ul>\n<li>JSONのエンコーダです。</li>\n<li><code class=\"language-text\">&quot;foo&quot;</code>を<code class=\"language-text\">{ &quot;data&quot;: &quot;foo&quot; }</code>に変換する実装になっています。</li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"elm\"><pre class=\"language-elm\"><code class=\"language-elm\"><span class=\"token comment\">-- SUBSCRIPTIONS</span>\n\n\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token operator\">:</span> <span class=\"token constant\">Model</span> <span class=\"token operator\">-></span> <span class=\"token constant\">Sub</span> <span class=\"token constant\">Msg</span>\n<span class=\"token hvariable\">subscriptions</span> <span class=\"token hvariable\">model</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">Websocket.websocketReceive</span> <span class=\"token constant\">WebsocketReceive</span></code></pre></div>\n<p><code class=\"language-text\">Websocket.websocketListen</code>で受信したメッセージを処理する関数を登録しています。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Elm 0.19 + Elixir/Phoenix 1.4でWebSocket通信を行う実装例を紹介しました。<br>\n参考になれば幸いです。</p>","frontmatter":{"title":"Elm 0.19 + Elixir/Phoenix 1.4でWebSocket通信","date":"2018-12-03","description":null,"header":{"childImageSharp":{"fluid":{"aspectRatio":1.5,"src":"/static/d5f7cb8ecd53bf35a28a9a15e39f9be2/d8255/header.jpg","srcSet":"/static/d5f7cb8ecd53bf35a28a9a15e39f9be2/9104c/header.jpg 480w,\n/static/d5f7cb8ecd53bf35a28a9a15e39f9be2/a6352/header.jpg 960w,\n/static/d5f7cb8ecd53bf35a28a9a15e39f9be2/d8255/header.jpg 1920w","sizes":"(max-width: 1920px) 100vw, 1920px"}}},"ogp":{"publicURL":"/static/a8b99a21a63b303e1a6f4d259fbe703f/ogp.jpg"},"tags":["Elm","Elixir","Phoenix","websocket"]},"tableOfContents":"<ul>\n<li><a href=\"/blog/elm-phoenix-websocket/#%E8%83%8C%E6%99%AF\">背景</a></li>\n<li>\n<p><a href=\"/blog/elm-phoenix-websocket/#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90%E3%81%BE%E3%81%A7\">プロジェクト作成まで</a></p>\n<ul>\n<li><a href=\"/blog/elm-phoenix-websocket/#elm%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\">Elmインストール</a></li>\n<li><a href=\"/blog/elm-phoenix-websocket/#elixirphoenix%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\">Elixir/Phoenixインストール</a></li>\n<li><a href=\"/blog/elm-phoenix-websocket/#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E4%BD%9C%E6%88%90\">プロジェクト作成</a></li>\n</ul>\n</li>\n<li><a href=\"/blog/elm-phoenix-websocket/#elm%E3%81%A7%E7%94%BB%E9%9D%A2%E8%A1%A8%E7%A4%BA\">Elmで画面表示</a></li>\n<li>\n<p><a href=\"/blog/elm-phoenix-websocket/#websocket%E5%AE%9F%E8%A3%85\">WebSocket実装</a></p>\n<ul>\n<li><a href=\"/blog/elm-phoenix-websocket/#phoenix%E5%81%B4\">Phoenix側</a></li>\n<li><a href=\"/blog/elm-phoenix-websocket/#elm%E5%81%B4\">Elm側</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/blog/elm-phoenix-websocket/#%E8%A7%A3%E8%AA%AC\">解説</a></p>\n<ul>\n<li><a href=\"/blog/elm-phoenix-websocket/#phoenix%E5%81%B4-1\">Phoenix側</a></li>\n<li><a href=\"/blog/elm-phoenix-websocket/#elm%E5%81%B4-1\">Elm側</a></li>\n</ul>\n</li>\n<li><a href=\"/blog/elm-phoenix-websocket/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>"}},"pageContext":{"id":"b6e78c97-6a09-5e5b-a2c2-e49498c62f7d"}},"staticQueryHashes":["3159585216","3357329864","3862782001","4070466330"]}