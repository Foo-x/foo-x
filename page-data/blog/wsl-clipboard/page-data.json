{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/wsl-clipboard/","result":{"data":{"markdownRemark":{"fields":{"slug":"/blog/wsl-clipboard/"},"id":"895eafac-a755-5851-bf25-37557d081171","excerpt":"WSLからWindows…","html":"<p>WSLからWindowsのクリップボードにコピーする方法を試行錯誤したのでまとめ。</p>\n<h2 id=\"結論\" style=\"position:relative;\"><a href=\"#%E7%B5%90%E8%AB%96\" aria-label=\"結論 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>結論</h2>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">pbcopy</span><span class=\"token operator\">=</span><span class=\"token string\">\"iconv -t utf16 | tail -c +3 | clip.exe\"</span></code></pre></div>\n<p>もしくは</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">pbcopy</span><span class=\"token operator\">=</span><span class=\"token string\">\"powershell.exe -command '[Console]::InputEncoding = [System.Text.Encoding]::UTF8; \\<span class=\"token variable\">$reader</span> = [System.IO.StreamReader]::new([System.IO.Stream]::Synchronized([System.Console]::OpenStandardInput())); \\<span class=\"token variable\">$reader</span>.ReadToEnd() | Set-Clipboard'\"</span></code></pre></div>\n<h2 id=\"過程\" style=\"position:relative;\"><a href=\"#%E9%81%8E%E7%A8%8B\" aria-label=\"過程 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>過程</h2>\n<h3 id=\"clipexe-を使う方法\" style=\"position:relative;\"><a href=\"#clipexe-%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95\" aria-label=\"clipexe を使う方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">clip.exe</code> を使う方法</h3>\n<p>・<code class=\"language-text\">clip.exe</code></p>\n<p>検索して最初に出てくる方法。\n最も簡単だが、日本語が文字化けする。</p>\n<p>・<code class=\"language-text\">iconv -t sjis | clip.exe</code></p>\n<p>日本語は問題ないが、<code class=\"language-text\">～</code> や <code class=\"language-text\">①</code> のような拡張文字が文字化けする。</p>\n<p>・<code class=\"language-text\">iconv -t cp932 | clip.exe</code></p>\n<p>日本語も拡張文字も問題ないが、絵文字が含まれるとエラーになる。</p>\n<p>・<code class=\"language-text\">iconv -t utf16 | clip.exe</code></p>\n<p>日本語、拡張文字、絵文字すべてコピーできるが、先頭に BOM (U+FEFF) が付与されてしまう。</p>\n<p>・<code class=\"language-text\">iconv -t utf16 | tail -c +3 | clip.exe</code></p>\n<p>BOMを除くことで解決。</p>\n<h3 id=\"powershellの-set-clipboard-を使う方法\" style=\"position:relative;\"><a href=\"#powershell%E3%81%AE-set-clipboard-%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95\" aria-label=\"powershellの set clipboard を使う方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Powershellの <code class=\"language-text\">Set-Clipboard</code> を使う方法</h3>\n<p>・<code class=\"language-text\">powershell.exe -command 'Read-Host | Set-Clipboard'</code></p>\n<p>日本語が文字化けする。</p>\n<p>・<code class=\"language-text\">powershell.exe -command '[Console]::InputEncoding = [System.Text.Encoding]::UTF8; Read-Host | Set-Clipboard'</code></p>\n<p>日本語、拡張文字、絵文字すべてコピーできるが、改行が含まれると1行目しかコピーされない。</p>\n<p>・<code class=\"language-text\">powershell.exe -command '[Console]::InputEncoding = [System.Text.Encoding]::UTF8; $reader = [System.IO.StreamReader]::new([System.IO.Stream]::Synchronized([System.Console]::OpenStandardInput())); $reader.ReadToEnd() | Set-Clipboard'</code></p>\n<p>改行も含めて解決。</p>\n<p>なお、「結論」で <code class=\"language-text\">$</code> をエスケープしているのはシェルの変数として展開されないようにするため。\nしたがって、</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">pbcopy</span><span class=\"token operator\">=</span><span class=\"token string\">'powershell.exe -command '</span><span class=\"token punctuation\">\\</span>'<span class=\"token string\">'[Console]::InputEncoding = [System.Text.Encoding]::UTF8; $reader = [System.IO.StreamReader]::new([System.IO.Stream]::Synchronized([System.Console]::OpenStandardInput())); $reader.ReadToEnd() | Set-Clipboard'</span><span class=\"token punctuation\">\\</span>'</code></pre></div>\n<p>としても良い。</p>\n<h2 id=\"クリップボードからの出力\" style=\"position:relative;\"><a href=\"#%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%E3%81%8B%E3%82%89%E3%81%AE%E5%87%BA%E5%8A%9B\" aria-label=\"クリップボードからの出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>クリップボードからの出力</h2>\n<p>クリップボードからの出力は <code class=\"language-text\">clip.exe</code> ではできないので、Powershellの <code class=\"language-text\">Get-Clipboard</code> を使う。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token builtin class-name\">alias</span> <span class=\"token assign-left variable\">pbpaste</span><span class=\"token operator\">=</span><span class=\"token string\">\"powershell.exe -command '[Console]::OutputEncoding = [System.Text.Encoding]::UTF8; Get-Clipboard'\"</span></code></pre></div>","frontmatter":{"title":"WSLで絵文字を含む文字列をクリップボードにコピーする","date":"2023-12-03","description":null,"header":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","images":{"fallback":{"src":"/static/bc47dd09c35ece4557a5ddddd829625f/5267c/header.jpg","srcSet":"/static/bc47dd09c35ece4557a5ddddd829625f/7284f/header.jpg 750w,\n/static/bc47dd09c35ece4557a5ddddd829625f/29ba9/header.jpg 1080w,\n/static/bc47dd09c35ece4557a5ddddd829625f/c8896/header.jpg 1366w,\n/static/bc47dd09c35ece4557a5ddddd829625f/5267c/header.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/bc47dd09c35ece4557a5ddddd829625f/57584/header.webp 750w,\n/static/bc47dd09c35ece4557a5ddddd829625f/984df/header.webp 1080w,\n/static/bc47dd09c35ece4557a5ddddd829625f/4a276/header.webp 1366w,\n/static/bc47dd09c35ece4557a5ddddd829625f/9c00f/header.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6666666666666666}}},"ogp":{"publicURL":"/static/500a31dbd315866551b07bf85d409601/ogp.jpg"},"tags":["WSL","Powershell"]},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E7%B5%90%E8%AB%96\">結論</a></p>\n</li>\n<li>\n<p><a href=\"#%E9%81%8E%E7%A8%8B\">過程</a></p>\n<ul>\n<li><a href=\"#clipexe-%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95\"><code class=\"language-text\">clip.exe</code> を使う方法</a></li>\n<li><a href=\"#powershell%E3%81%AE-set-clipboard-%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95\">Powershellの <code class=\"language-text\">Set-Clipboard</code> を使う方法</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89%E3%81%8B%E3%82%89%E3%81%AE%E5%87%BA%E5%8A%9B\">クリップボードからの出力</a></p>\n</li>\n</ul>"}},"pageContext":{"id":"895eafac-a755-5851-bf25-37557d081171"}},"staticQueryHashes":["1025666349","2148507062","4241674040","739241604"],"slicesMap":{}}